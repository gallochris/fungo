---
title: "Scraping Odds"
author: "Chris Gallo"
date: 2020-07-24
categories: ["R"]
slug: "scrape-odds"
type: "post"
tags: ["R Markdown", "Fungo Friday"]
published: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE, message=FALSE}
library(knitr)
library(rvest)

odds <- read_html('https://www.oddsboom.com/nba/futures/22-nba-championship/')

team <- odds %>% 
  rvest::html_nodes('table') %>% 
  xml2::xml_find_all("//td[contains(@class, 'competitor')]") %>% 
  rvest::html_text()

pb <- odds %>% 
  rvest::html_nodes('table') %>% 
  xml2::xml_find_all("//td[contains(@class, 'goto b3 _b3 odds-cell null   odds-best')]") %>% 
  rvest::html_text()



chart_df <- data.frame(team, pb)

kable(chart_df, col.names = c("Team",
                           "Best365"
                           ), caption = "NBA Champ Odds", format="markdown")


```
---

Web scraping sounds hard. I'm finding it's not too difficult with tools like [rvest](https://blog.rstudio.com/2014/11/24/rvest-easy-web-scraping-with-r/). 

This is a simple example pulling together markdown table of team's odds to make the NBA Championship. It pulls from [OddsBoom](https://www.oddsboom.com/nba/futures/22-nba-championship/) and selects the odds from a sportsbook(s). 

There isn't any sorting, converting of the odds, and styling done.

Code is below . . .

```
library(knitr)
library(rvest)

odds <- read_html('https://www.oddsboom.com/nba/futures/22-nba-championship/')

team <- odds %>% 
  rvest::html_nodes('table') %>% 
  xml2::xml_find_all("//td[contains(@class, 'competitor')]") %>% 
  rvest::html_text()

pb <- odds %>% 
  rvest::html_nodes('table') %>% 
  xml2::xml_find_all("//td[contains(@class, 'goto pb _pb odds-cell null  odds-above-average ')]") %>% 
  rvest::html_text()

dk <- odds %>% 
  rvest::html_nodes('table') %>% 
  xml2::xml_find_all("//td[contains(@class, 'goto dk _dk odds-cell null')]") %>% 
  rvest::html_text()


chart_df <- data.frame(team, pb, dk)

kable(chart_df, col.names = c("Team",
                           "PointsBet",
                           "DraftKings"
                           ), caption = "NBA Champ Odds", format="markdown")

```
